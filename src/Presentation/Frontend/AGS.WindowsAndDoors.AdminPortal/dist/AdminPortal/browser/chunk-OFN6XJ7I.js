import{a as z,b as L,c as s,d as Ge,e as ze,f as We,g as Je,h as O,i as Ye,j as Ze,k as et,l as tt}from"./chunk-OTPEX7W3.js";import{A as Qe,B as Xe,a as se,c as j,h as qe,i as Ve,z as Ke}from"./chunk-5XJJSVLH.js";import"./chunk-LIUWO5X6.js";import{c as Be,d as $e,e as He,f as je,j as Ae}from"./chunk-FGSM2V4H.js";import{b as ge,d as N,f as Ce,g as xe,i as U,j as he,k as Ie,l as ve,m as Me,o as be,p as Ee,q as Se}from"./chunk-7JKDIDZM.js";import{a as Pe,b as ye,c as we,d as Te,e as De,f as Fe,g as Le,h as Oe,i as Re,j as ke,k as Ne}from"./chunk-RE56AKVS.js";import{g as Ue,h as A,i as G}from"./chunk-EVMOKHPF.js";import"./chunk-CFKZANUC.js";import{a as de,b as ce,c as pe,e as ue,f as _e,h as fe}from"./chunk-VK64GV6O.js";import{$a as g,B as _,Ca as l,Cb as ne,Db as a,Eb as h,Fb as B,Lb as oe,Mb as re,O as T,Oa as b,Pb as $,R as f,Sa as E,Sb as ae,V as ie,_ as u,_a as Y,ab as C,bb as M,ca as I,cb as o,da as v,db as n,e as te,eb as p,ib as S,jb as P,jc as me,kc as H,lb as y,m as w,n as V,nb as x,oa as X,oc as le,pb as c,uc as D,vc as F}from"./chunk-ZXXEUBV7.js";var W=class e{http=u(le);baseUrl="/api/items";getItems(){return this.http.get(this.baseUrl).pipe(_(this.handleError))}getItem(i){return this.http.get(`${this.baseUrl}/${i}`).pipe(_(this.handleError))}createItem(i){let t={code:i.code.trim().toUpperCase(),name:i.name.trim(),description:i.description,price:i.price,dimensionValue:null,dimensionUnit:i.measure,colorName:null,colorHex:null};return this.http.post(this.baseUrl,t).pipe(_(this.handleError))}updateItem(i,t){let r={};return t.name!==void 0&&(r.name=t.name.trim()),t.measure!==void 0&&(r.dimensionUnit=t.measure),this.http.put(`${this.baseUrl}/${i}`,r).pipe(_(this.handleError))}deleteItem(i){return this.http.delete(`${this.baseUrl}/${i}`).pipe(_(this.handleError))}handleError=i=>(console.error("API Error:",i),i.status===409?V(()=>new Error(i.error?.message||"Item code already exists")):i.status===404?V(()=>new Error("Item not found")):V(()=>new Error("An unexpected error occurred")));static \u0275fac=function(t){return new(t||e)};static \u0275prov=ie({token:e,factory:e.\u0275fac,providedIn:"root"})};var ot={items:[],loading:!1,error:null},K=Ge({providedIn:"root"},Je(ot),ze(e=>({hasItems:$(()=>e.items().length>0),itemCount:$(()=>e.items().length),isEmpty:$(()=>e.items().length===0)})),We(e=>{let i=u(W);return{setLoading:t=>s(e,{loading:t}),setError:t=>s(e,{error:t}),addItem:t=>s(e,r=>({items:[...r.items,t]})),updateItem:t=>s(e,r=>({items:r.items.map(m=>m.code===t.code?t:m)})),removeItem:t=>s(e,r=>({items:r.items.filter(m=>m.code!==t)})),clearError:()=>s(e,{error:null}),loadItems:O(te(f(()=>s(e,{loading:!0,error:null})),T(()=>i.getItems().pipe(f(t=>s(e,{items:t,loading:!1})),_(t=>(s(e,{items:[],loading:!1,error:t.message}),w([]))))))),createItem:O(t=>t.pipe(f(()=>s(e,{loading:!0,error:null})),T(r=>i.createItem(r).pipe(f(m=>s(e,d=>({items:[...d.items,m],loading:!1}))),_(m=>(s(e,{loading:!1,error:m.message}),w(null))))))),updateItemByCode:O(t=>t.pipe(f(()=>s(e,{loading:!0,error:null})),T(([r,m])=>i.updateItem(r,m).pipe(f(d=>s(e,nt=>({items:nt.items.map(ee=>ee.code===d.code?d:ee),loading:!1}))),_(d=>(s(e,{loading:!1,error:d.message}),w(null))))))),deleteItemByCode:O(t=>t.pipe(f(()=>s(e,{loading:!0,error:null})),T(r=>i.deleteItem(r).pipe(f(()=>s(e,m=>({items:m.items.filter(d=>d.code!==r),loading:!1}))),_(m=>(s(e,{loading:!1,error:m.message}),w(null))))))),getItem:O(t=>t.pipe(f(()=>s(e,{loading:!0,error:null})),T(r=>i.getItem(r).pipe(f(()=>s(e,{loading:!1})),_(m=>(s(e,{loading:!1,error:m.message}),w(null)))))))}}));var R=class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=b({type:e,selectors:[["app-loading-indicator"]],decls:4,vars:0,consts:[[1,"loading-container"],["diameter","40"]],template:function(t,r){t&1&&(o(0,"div",0),p(1,"mat-spinner",1),o(2,"span"),a(3,"Loading..."),n()())},dependencies:[L,z],styles:[".loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px;gap:12px}mat-spinner[_ngcontent-%COMP%]{margin:0}span[_ngcontent-%COMP%]{font-size:14px;color:var(--mat-sys-on-surface)}"]})};var k=class e{message=ae.required();static \u0275fac=function(t){return new(t||e)};static \u0275cmp=b({type:e,selectors:[["app-error-message"]],inputs:{message:[1,"message"]},decls:5,vars:1,consts:[["role","alert","aria-live","polite",1,"error-container"],[1,"error-icon"],[1,"error-text"]],template:function(t,r){t&1&&(o(0,"div",0)(1,"mat-icon",1),a(2,"error_outline"),n(),o(3,"span",2),a(4),n()()),t&2&&(l(4),h(r.message()))},dependencies:[F,D],styles:[".error-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background-color:var(--mat-sys-error-container);border-radius:8px;border-left:4px solid var(--mat-sys-error)}.error-icon[_ngcontent-%COMP%]{color:var(--mat-sys-error);font-size:20px;width:20px;height:20px}.error-text[_ngcontent-%COMP%]{color:var(--mat-sys-error);font-size:14px;line-height:1.4}"]})};function mt(e,i){e&1&&p(0,"app-loading-indicator")}function lt(e,i){if(e&1){let t=y();p(0,"app-error-message",4),o(1,"button",5),x("click",function(){I(t);let m=c();return v(m.retryLoad())}),o(2,"mat-icon"),a(3,"refresh"),n(),a(4," Retry "),n()}e&2&&M("message",i)}function st(e,i){if(e&1){let t=y();o(0,"div",6)(1,"mat-icon",8),a(2,"inventory_2"),n(),o(3,"h3"),a(4,"No items found"),n(),o(5,"p"),a(6,"Get started by creating your first item."),n(),o(7,"button",2),x("click",function(){I(t);let m=c(3);return v(m.navigateToNew())}),o(8,"mat-icon"),a(9,"add"),n(),a(10," Create First Item "),n()()}}function dt(e,i){e&1&&(o(0,"th",19),a(1,"Code"),n())}function ct(e,i){if(e&1&&(o(0,"td",20),a(1),n()),e&2){let t=i.$implicit;l(),h(t.code)}}function pt(e,i){e&1&&(o(0,"th",19),a(1,"Name"),n())}function ut(e,i){if(e&1&&(o(0,"td",20),a(1),n()),e&2){let t=i.$implicit;l(),h(t.name)}}function _t(e,i){e&1&&(o(0,"th",19),a(1,"Price"),n())}function ft(e,i){if(e&1&&(o(0,"td",20),a(1),oe(2,"currency"),n()),e&2){let t=i.$implicit;l(),h(re(2,1,t.price))}}function gt(e,i){e&1&&(o(0,"th",19),a(1,"Measure"),n())}function Ct(e,i){if(e&1&&(o(0,"td",20),a(1),n()),e&2){let t=i.$implicit;l(),h((t.dimensions==null?null:t.dimensions.unit)||"Units")}}function xt(e,i){e&1&&(o(0,"th",19),a(1,"State"),n())}function ht(e,i){if(e&1&&(o(0,"td",20)(1,"span"),a(2),n()()),e&2){let t=i.$implicit;l(),ne("state-"+t.state.toLowerCase()),l(),B(" ",t.state," ")}}function It(e,i){e&1&&(o(0,"th",19),a(1,"Actions"),n())}function vt(e,i){if(e&1){let t=y();o(0,"td",20)(1,"button",21),x("click",function(){let m=I(t).$implicit,d=c(4);return v(d.editItem(m.code))}),o(2,"mat-icon"),a(3,"edit"),n()(),o(4,"button",22),x("click",function(){let m=I(t).$implicit,d=c(4);return v(d.deleteItem(m))}),o(5,"mat-icon"),a(6,"delete"),n()()()}if(e&2){let t=i.$implicit;l(),Y("aria-label","Edit "+t.name),l(3),Y("aria-label","Delete "+t.name)}}function Mt(e,i){e&1&&p(0,"tr",23)}function bt(e,i){e&1&&p(0,"tr",24)}function Et(e,i){if(e&1&&(o(0,"table",7),S(1,9),E(2,dt,2,0,"th",10)(3,ct,2,1,"td",11),P(),S(4,12),E(5,pt,2,0,"th",10)(6,ut,2,1,"td",11),P(),S(7,13),E(8,_t,2,0,"th",10)(9,ft,3,3,"td",11),P(),S(10,14),E(11,gt,2,0,"th",10)(12,Ct,2,1,"td",11),P(),S(13,15),E(14,xt,2,0,"th",10)(15,ht,3,3,"td",11),P(),S(16,16),E(17,It,2,0,"th",10)(18,vt,7,2,"td",11),P(),E(19,Mt,1,0,"tr",17)(20,bt,1,0,"tr",18),n()),e&2){let t=c(),r=c(2);M("dataSource",t),l(19),M("matHeaderRowDef",r.displayedColumns),l(),M("matRowDefColumns",r.displayedColumns)}}function St(e,i){e&1&&g(0,st,11,0,"div",6)(1,Et,21,3,"table",7),e&2&&C(i.length===0?0:1)}function Pt(e,i){if(e&1&&(o(0,"div",3),g(1,St,2,1),n()),e&2){let t,r=c();l(),C((t=r.items())?1:-1,t)}}var Q=class e{router=u(j);itemsStore=u(K);displayedColumns=["code","name","price","measure","state","actions"];items=this.itemsStore.items;loading=this.itemsStore.loading;error=this.itemsStore.error;constructor(){this.itemsStore.loadItems()}navigateToNew(){this.router.navigate(["new"],{relativeTo:this.router.routerState.root.firstChild})}editItem(i){this.router.navigate([i,"edit"],{relativeTo:this.router.routerState.root.firstChild})}deleteItem(i){console.log("Delete item:",i.code)}retryLoad(){this.itemsStore.clearError(),this.itemsStore.loadItems()}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=b({type:e,selectors:[["app-items-list"]],decls:11,vars:1,consts:[[1,"page-container"],["color","primary",1,"toolbar"],["mat-raised-button","","color","accent",3,"click"],[1,"content"],[3,"message"],["mat-button","",3,"click"],[1,"empty-state"],["mat-table","",1,"items-table",3,"dataSource"],[1,"empty-icon"],["matColumnDef","code"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","price"],["matColumnDef","measure"],["matColumnDef","state"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,r){if(t&1&&(o(0,"div",0)(1,"mat-toolbar",1)(2,"h1"),a(3,"Items Catalog"),n(),o(4,"button",2),x("click",function(){return r.navigateToNew()}),o(5,"mat-icon"),a(6,"add"),n(),a(7," New Item "),n()(),g(8,mt,1,0,"app-loading-indicator")(9,lt,5,1)(10,Pt,2,1,"div",3),n()),t&2){let m;l(8),C((m=r.loading())?8:(m=r.error())?9:10,m)}},dependencies:[H,Ne,Pe,we,Le,Te,ye,Oe,De,Fe,Re,ke,G,A,Ue,F,D,Ve,qe,L,R,k,me],styles:[".page-container[_ngcontent-%COMP%]{height:100vh;display:flex;flex-direction:column}.toolbar[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 auto 0 0;font-size:24px;font-weight:400}.content[_ngcontent-%COMP%]{flex:1;padding:24px;overflow-y:auto}.items-table[_ngcontent-%COMP%]{width:100%}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:48px;max-width:400px;margin:0 auto}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;opacity:.5;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:16px 0 8px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:24px;color:var(--mat-sys-on-surface-variant)}.state-draft[_ngcontent-%COMP%]{color:var(--mat-sys-secondary)}.state-active[_ngcontent-%COMP%]{color:var(--mat-sys-primary)}.state-inactive[_ngcontent-%COMP%]{color:var(--mat-sys-error)}button[_ngcontent-%COMP%]{margin-left:4px}"]})};function yt(e,i){e&1&&p(0,"app-loading-indicator")}function wt(e,i){e&1&&p(0,"app-error-message",2),e&2&&M("message",i)}function Tt(e,i){e&1&&(o(0,"mat-error"),a(1,"Code is required"),n())}function Dt(e,i){e&1&&(o(0,"mat-error"),a(1,"Name is required"),n())}function Ft(e,i){e&1&&(o(0,"mat-error"),a(1,"Price is required"),n())}function Lt(e,i){e&1&&(o(0,"mat-error"),a(1,"Price must be positive"),n())}function Ot(e,i){if(e&1){let t=y();o(0,"form",5),x("ngSubmit",function(){I(t);let m=c();return v(m.onSubmit())}),o(1,"mat-form-field",6)(2,"mat-label"),a(3,"Item Code"),n(),p(4,"input",7),o(5,"mat-hint"),a(6,"Type the code for this item"),n(),g(7,Tt,2,0,"mat-error"),n(),o(8,"mat-form-field",6)(9,"mat-label"),a(10,"Item Name"),n(),p(11,"input",8),o(12,"mat-hint"),a(13,"Enter a descriptive name"),n(),g(14,Dt,2,0,"mat-error"),n(),o(15,"mat-form-field",6)(16,"mat-label"),a(17,"Price"),n(),p(18,"input",9),o(19,"span",10),a(20,"$"),n(),g(21,Ft,2,0,"mat-error")(22,Lt,2,0,"mat-error"),n(),o(23,"mat-form-field",6)(24,"mat-label"),a(25,"Measure Unit"),n(),o(26,"mat-select",11)(27,"mat-option",12),a(28,"Units"),n(),o(29,"mat-option",13),a(30,"Inches"),n()(),o(31,"mat-hint"),a(32,"Unit of measurement for pricing"),n()()()}if(e&2){let t,r,m,d=c();M("formGroup",d.itemForm),l(7),C((t=d.itemForm.get("code"))!=null&&t.hasError("required")?7:-1),l(7),C((r=d.itemForm.get("name"))!=null&&r.hasError("required")?14:-1),l(7),C((m=d.itemForm.get("price"))!=null&&m.hasError("required")?21:(m=d.itemForm.get("price"))!=null&&m.hasError("min")?22:-1)}}function Rt(e,i){e&1&&p(0,"mat-spinner",16)}function kt(e,i){if(e&1&&(o(0,"mat-icon"),a(1),n()),e&2){let t=c(2);l(),h(t.isEditing()?"save":"add")}}function Nt(e,i){if(e&1){let t=y();o(0,"mat-card-actions",4)(1,"button",14),x("click",function(){I(t);let m=c();return v(m.onCancel())}),a(2,"Cancel"),n(),o(3,"button",15),x("click",function(){I(t);let m=c();return v(m.onSubmit())}),g(4,Rt,1,0,"mat-spinner",16)(5,kt,2,1,"mat-icon"),a(6),n()()}if(e&2){let t=c();l(3),M("disabled",t.itemForm.invalid||t.loading()),l(),C(t.loading()?4:5),l(2),B(" ",t.isEditing()?"Update Item":"Create Item"," ")}}var q=class e{fb=u(Ee);route=u(se);router=u(j);state=u(K);snackBar=u(tt);items=this.state.items;loading=this.state.loading;error=this.state.error;isEditing=X(!1);editingCode=X(null);itemForm=this.fb.group({code:new U("",[N.required]),name:new U("",[N.required]),price:new U(0,[N.required,N.min(0)]),measure:new U("Units")});constructor(){let i=this.route.snapshot.params.code,t=this.route.snapshot.url.some(r=>r.path==="edit");i&&t&&(this.isEditing.set(!0),this.editingCode.set(i),this.loadItem(i))}loadItem(i){this.state.clearError(),this.state.getItem(i)}onSubmit(){if(this.itemForm.invalid){this.markFormGroupTouched();return}this.state.clearError();let i=this.itemForm.value;if(this.isEditing()&&this.editingCode()){let t={name:i.name||void 0,measure:i.measure||void 0};this.state.updateItemByCode([this.editingCode(),t]),this.showSuccess("Item updated successfully"),this.navigateBack()}else{let t={code:i.code,name:i.name,description:`Item created at ${new Date().toISOString()}`,price:i.price,measure:i.measure};this.state.createItem(t),this.showSuccess("Item created successfully"),this.navigateBack()}}onCancel(){this.navigateBack()}showSuccess(i){this.snackBar.open(i,"Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"bottom"})}navigateBack(){this.router.navigate(["../"],{relativeTo:this.route.parent})}markFormGroupTouched(){Object.keys(this.itemForm.controls).forEach(i=>{this.itemForm.get(i)?.markAsTouched()})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=b({type:e,selectors:[["app-item-form"]],decls:10,vars:3,consts:[[1,"form-container"],[1,"form-card"],[3,"message"],[1,"item-form",3,"formGroup"],[1,"form-actions"],[1,"item-form",3,"ngSubmit","formGroup"],["appearance","outline",1,"field"],["matInput","","formControlName","code","placeholder","e.g. FRM001","required",""],["matInput","","formControlName","name","placeholder","e.g. Window Frame","required",""],["matInput","","type","number","step","0.01","formControlName","price","placeholder","0.00","required",""],["matPrefix",""],["formControlName","measure"],["value","Units"],["value","Inches"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"click","disabled"],["diameter","20"]],template:function(t,r){if(t&1&&(o(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title"),a(4),n()(),o(5,"mat-card-content"),g(6,yt,1,0,"app-loading-indicator")(7,wt,1,1,"app-error-message",2)(8,Ot,33,4,"form",3),n(),g(9,Nt,7,3,"mat-card-actions",4),n()()),t&2){let m;l(4),h(r.isEditing()?"Edit Item":"Create New Item"),l(2),C((m=r.loading())?6:(m=r.error())?7:8,m),l(3),C(!r.loading()&&!r.error()?9:-1)}},dependencies:[H,Se,he,ge,Ie,Ce,xe,be,Me,ve,Ke,Ae,Be,He,$e,je,Xe,Qe,et,Ze,Ye,G,A,fe,de,ue,pe,_e,ce,F,D,L,z,R,k],styles:[".form-container[_ngcontent-%COMP%]{padding:24px;display:flex;justify-content:center;min-height:100vh}.form-card[_ngcontent-%COMP%]{max-width:600px;width:100%}.item-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;margin-top:16px}.field[_ngcontent-%COMP%]{width:100%}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;padding:16px}mat-spinner[_ngcontent-%COMP%]{margin-right:8px}button[_ngcontent-%COMP%]{min-width:120px}"]})};var Qi=[{path:"",component:Q,title:"Items"},{path:"new",component:q,title:"New Item"},{path:":code/edit",component:q,title:"Edit Item"}];export{Qi as ITEMS_ROUTES,q as ItemFormPage,Q as ItemsListPage};
